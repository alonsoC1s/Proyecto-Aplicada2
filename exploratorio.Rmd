---
title: "Exploración de variables y el modelo."
author:
    - Alonso Martinez
    - Enrique Ampudia
    - Ana Tena
    - Rodrigo Peralta
    - Cecilia Ramirez
date: '2022-05-10'
output: revealjs::revealjs_presentation
---

# Análisis exploratorio

```{r, echo=FALSE}
library("ggplot2")
library("dplyr")
library("nlme")

info <- read.csv('procesados.csv')
info <- info[info['CONTAMINANTE'] == 'CO',]
info <- info[-nrow(info),] #eliminamos 2020
```

## Autos & promedio de CO a través del tiempo.
```{R, echo=FALSE}
ggplot(data=info, mapping = aes(AÑO, MEAN_CONT)) +
    geom_point() +
    geom_smooth() + 
    labs(
        x = "Año", y = "Media anual de CO"
    )
```


## Autos & promedio de CO a través del tiempo.
```{R, echo=FALSE}
ggplot(data=info, mapping = aes(AÑO, AUTOMOVILES)) +
    geom_point() +
    geom_smooth() + 
    labs(
        x = "Año", y = "Número de automóviles registrados"
    )
```


## Autos & promedio de CO a través del tiempo.
```{R, echo=FALSE}
ggplot(data=info, mapping = aes(AÑO, POBLACION / 1e6)) +
    geom_point() +
    geom_smooth() + 
    labs(
        x = "Año", y = "Población en millones"
    )
```

## Número de estaciones de de transporte público eléctrico a través del tiempo
```{R, echo=FALSE}
ggplot(data=info, mapping = aes(AÑO,  EST_V)) +
    geom_point() +
    geom_smooth() + 
    labs(
        x = "Año", y = "Estaciones de transporte público eléctrico"
    )
```

## Dado lo observado quitamos los datos antes del 1993

```{R, echo=FALSE}
info <- info |>
    dplyr::filter(AÑO > 1994)
```

## Autos & promedio de CO a través del tiempo con el arreglo

```{R, echo=FALSE}
ggplot(data=info, mapping = aes(AÑO, MEAN_CONT)) +
    geom_point() +
    geom_smooth() + 
    labs(
        x = "Año", y = "Media anual de CO"
    )
```


## Pruebas de hipótesis

# Especificación del modelo de regresión

$$
\ln(\text{CO}_{t}) = \beta_0 + \beta_1 \ln(\text{POBLACION}_{t}) + \beta_2 \ln(\text{EST\_V}_{t})  + \beta_3 \ln(\text{AUTOMOVILES}_{t})
$$

En R lo espcificamos así:

```{R}
spec <- log(MEAN_CONT) ~ log(POBLACION) + log(EST_V) + log(AUTOMOVILES)
```


# Estimación del modelo 

## Estimación OLS
```{R}
m_ols <- lm(spec, data=info)
summary(m_ols)
```

## Estimación GLS
Uso el paquete `nlme`.

```{R}
m_gls <- gls(spec, data=info)
summary(m_gls)
```


## Resultados
La estimación es idéntica, pero se ve que si hay correlaciones entre variables por la matriz de correlaciones.

- Está bien hecho?
- Son malas noticias?